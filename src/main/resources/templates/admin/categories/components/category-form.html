<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Category Form</title>
</head>

<body>
    <!-- Category Form -->
    <div class="row">
        <!-- Basic Information -->
        <div class="col-md-6">
            <div class="mb-3">
                <label for="name" class="form-label">Tên danh mục <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="name" name="name" th:field="*{name}" required>
                <div class="invalid-feedback" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="mb-3">
                <label for="parentId" class="form-label">Danh mục cha</label>
                <select class="form-select" id="parentId" name="parentId" th:field="*{parentId}">
                    <option value="">Không có (danh mục gốc)</option>
                    <option th:each="parent : ${parentCategories}" th:value="${parent.id}" th:text="${parent.name}">
                    </option>
                </select>
                <div class="form-text">Để trống nếu đây là danh mục gốc</div>
            </div>
        </div>
    </div>

    <!-- Description -->
    <div class="mb-3">
        <label for="description" class="form-label">Mô tả</label>
        <textarea class="form-control" id="description" name="description" th:field="*{description}"
            rows="4"></textarea>
    </div>

    <!-- Slug -->
    <div class="mb-3">
        <label for="slug" class="form-label">URL Slug</label>
        <input type="text" class="form-control" id="slug" name="slug" th:field="*{slug}">
        <div class="form-text">URL thân thiện (tự động tạo từ tên danh mục)</div>
    </div>

    <!-- Sort Order -->
    <div class="row">
        <div class="col-md-6">
            <div class="mb-3">
                <label for="sortOrder" class="form-label">Thứ tự sắp xếp</label>
                <input type="number" class="form-control" id="sortOrder" name="sortOrder" th:field="*{sortOrder}"
                    min="0" value="0">
                <div class="form-text">Số càng nhỏ càng hiển thị trước</div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="mb-3">
                <label for="icon" class="form-label">Icon</label>
                <input type="text" class="form-control" id="icon" name="icon" th:field="*{icon}"
                    placeholder="fas fa-mobile-alt">
                <div class="form-text">Font Awesome icon class (ví dụ: fas fa-mobile-alt)</div>
            </div>
        </div>
    </div>

    <!-- Color -->
    <div class="mb-3">
        <label for="color" class="form-label">Màu sắc</label>
        <div class="input-group">
            <input type="color" class="form-control form-control-color" id="color" name="color" th:field="*{color}"
                value="#007bff">
            <input type="text" class="form-control" id="colorText" placeholder="#007bff" readonly>
        </div>
        <div class="form-text">Màu sắc đại diện cho danh mục</div>
    </div>

    <!-- Features -->
    <div class="row">
        <div class="col-md-6">
            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="featured" name="featured"
                        th:field="*{featured}">
                    <label class="form-check-label" for="featured">
                        Danh mục nổi bật
                    </label>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="showInMenu" name="showInMenu"
                        th:field="*{showInMenu}">
                    <label class="form-check-label" for="showInMenu">
                        Hiển thị trong menu
                    </label>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="showInHomepage" name="showInHomepage"
                        th:field="*{showInHomepage}">
                    <label class="form-check-label" for="showInHomepage">
                        Hiển thị ở trang chủ
                    </label>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="isActive" name="isActive"
                        th:field="*{isActive}">
                    <label class="form-check-label" for="isActive">
                        Kích hoạt
                    </label>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Auto-generate slug from name
        document.getElementById('name').addEventListener('input', function () {
            const name = this.value;
            const slug = name
                .toLowerCase()
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '') // Remove diacritics
                .replace(/[^a-z0-9\s-]/g, '') // Remove special characters
                .replace(/\s+/g, '-') // Replace spaces with hyphens
                .replace(/-+/g, '-') // Replace multiple hyphens with single hyphen
                .trim('-'); // Remove leading/trailing hyphens

            document.getElementById('slug').value = slug;
        });

        // Sync color picker with text input
        document.getElementById('color').addEventListener('input', function () {
            document.getElementById('colorText').value = this.value;
        });

        document.getElementById('colorText').addEventListener('input', function () {
            if (this.value.match(/^#[0-9A-Fa-f]{6}$/)) {
                document.getElementById('color').value = this.value;
            }
        });
    </script>
</body>

</html>